function playlist_delete_item(a,b,c){return confirm(pm_lang.playlist_delete_item_confirm)&&(ajax_request("playlists","do=remove-item&video-id="+b+"&playlist-id="+a,"","",!1,"POST"),$(c).fadeOut("slow")),!1}function playlist_delete(a,b){return $(b).attr("disabled","disabled"),confirm(pm_lang.playlist_delete_confirm)?($("#playlist-modal-ajax-response").html("").hide(),$("#modal-loading-gif").show(),$.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:{p:"playlists",do:"delete-playlist","playlist-id":a},dataType:"json",success:function(a){a.success?window.location=MELODYURL2+"/playlists.php":($("#playlist-modal-ajax-response").html(a.html).show(),$("#modal-loading-gif").hide(),$(b).removeAttr("disabled"))}})):$("#modal-loading-gif").hide(),!1}function playlist_save_settings(a,b){return $("#playlist-modal-ajax-response").html("").hide(),$("#modal-loading-gif").show(),$(b).attr("disabled","disabled"),$.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:{p:"playlists",do:"update-playlist","playlist-id":a,title:$('input[name="playlist_name"]').val(),visibility:$('select[name="visibility"]').val(),sorting:$('select[name="sorting"]').val()},dataType:"json",success:function(a){a.success?location.reload():($("#playlist-modal-ajax-response").html(a.html).show(),$("#modal-loading-gif").hide(),$(b).removeAttr("disabled"))}}),!1}function playlist_create(a,b){b="undefined"!=typeof b?b:"playlists-modal";var c;return"video-watch"==b?(c="#playlist-create-ajax-response",$("#playlist-container").addClass("opac5")):(c="#playlist-modal-ajax-response",$("#modal-loading-gif").show()),$(c).hide().html(""),$(a).attr("disabled",!0),$.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:{p:"playlists",do:"create-playlist",title:$('input[name="playlist_name"]').val(),visibility:$('select[name="visibility"]').val(),sorting:$('select[name="sorting"]').val(),"video-id":$('input[name="video_id"]').val(),ui:b},dataType:"json",success:function(d){d.success?($(c).html(d.html).show(),"video-watch"==b?($("#playlist-container").replaceWith(d.html_content),$('input[name="playlist_name"]').attr("value",""),$(a).attr("disabled",!0)):location.reload()):($(c).html(d.html).show(),$(a).removeAttr("disabled"),"video-watch"==b?$("#playlist-container").removeClass("opac5"):$("#modal-loading-gif").hide())}}),!1}function playlist_add_item(a,b){$("#playlist-container").addClass("opac5"),$("#playlist-ajax-response").hide().html(""),$.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:{p:"playlists",do:"add-to-playlist","playlist-id":a,"video-id":b},dataType:"json",success:function(a){a.success?$("#playlist-container").replaceWith(a.html):($("#playlist-ajax-response").html(a.html).show(),$("#playlist-container").removeClass("opac5"))}})}function playlist_remove_item(a,b){$("#playlist-container").addClass("opac5"),$("#playlist-ajax-response").hide().html(""),$.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:{p:"playlists",do:"remove-from-playlist","playlist-id":a,"video-id":b},dataType:"json",success:function(a){a.success?$("#playlist-container").replaceWith(a.html):($("#playlist-ajax-response").html(a.html).show(),$("#playlist-container").removeClass("opac5"))}})}function watch_later_add(a){return $(".watch-later-add-btn-"+a).addClass("opac5"),watch_later(a,"watch-later-add")}function watch_later_remove(a){return $(".watch-later-remove-btn-"+a).addClass("opac5"),watch_later(a,"watch-later-remove")}function watch_later(a,b){$.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:{p:"playlists",do:b,"video-id":a},dataType:"json",success:function(c){"watch-later-add"==b?($(".watch-later-add-btn-"+a).hide().removeClass("opac5"),$(".watch-later-remove-btn-"+a).show()):($(".watch-later-add-btn-"+a).show(),$(".watch-later-remove-btn-"+a).hide().removeClass("opac5"))}})}function validateSearch(a){if(""==document.forms.search.keywords.value||"search"==document.forms.search.keywords.value){if(alert("You did not enter a search term. Please try again."),"true"==a)return!1}else document.forms.search.submit()}function lookup(a){0==a.length?$("#suggestions").hide():a.length>2&&$.post(MELODYURL2+"/ajax_search.php",{queryString:""+a},function(a){a.length>0&&($("#suggestions").show(),$("#autoSuggestionsList").html(a))})}function fill(a){$("#inputString").val(a),setTimeout("$('#suggestions').hide();",200)}function ajax_request(a,b,c,d,e,f){var g=!1;return f="undefined"!=typeof f?f:"GET",0==d.length&&(d="html"),c.length>0&&$(c).html('<img src="'+TemplateP+'/img/ajax-loading.gif" alt="Loading" id="loading" /> Loading...').fadeIn("normal"),$.ajax({type:f,url:MELODYURL2+"/ajax.php",data:"p="+a+"&"+b,dataType:d,success:function(b){c.length>0&&($(c).html(b),1==e&&($(c).show(),"comments"==a&&bind_comment_user_actions())),g=!0}}),g}function reportNotFound(a){a.length>0&&!arDone&&(ajax_request("video","do=report&vid="+a,"","",!1),arDone=!0)}function onpage_delete_comment(a,b,c){var d="You are about to delete this comment. Click 'Cancel' to stop, 'OK' to delete";confirm(d)&&c.length>0&&(ajax_request("comments","do=onpage_delete_comment&cid="+a+"&vid="+b,"","",!1),$(c).fadeOut("normal"))}function comment_user_action(a,b,c,d){var e="comments";return"ban"!=d&&"allow"!=d||(e="users"),$.ajax({type:"GET",url:MELODYURL2+"/ajax.php",data:{comment_id:b,uid:c,p:e,do:d},dataType:"json",success:function(e){e.success&&(a.hasClass("active")?a.removeClass("active"):(a.addClass("active"),"like"==d?$("#comment-dislike-"+b).removeClass("active"):"dislike"==d&&$("#comment-like-"+b).removeClass("active")),"allow"==d||"ban"==d?(1==e.show_label&&($(".label-banned-"+c).removeClass("hide").show(),$(".ban-"+c).addClass("active"),$(".unban-"+c).addClass("active")),1==e.hide_label&&($(".label-banned-"+c).hide(),$(".ban-"+c).removeClass("active"),$(".unban-"+c).removeClass("active"))):(e.up_vote_count>0?$("#comment-like-count-"+b).html(e.up_vote_count):$("#comment-like-count-"+b).html(""),e.down_vote_count>0?$("#comment-dislike-count-"+b).html(e.down_vote_count):$("#comment-dislike-count-"+b).html(""))),e.success||"allow"!=d&&"ban"!=d||""==e.error||alert(e.error)}}),!1}function bind_comment_user_actions(){$('button[id^="comment-like-"]').click(function(){var a=$(this).attr("id").replace(/^\D+/g,"");return comment_user_action($(this),a,0,"like"),!1}),$('button[id^="comment-dislike-"]').click(function(){var a=$(this).attr("id").replace(/^\D+/g,"");return comment_user_action($(this),a,0,"dislike"),!1}),$('button[id^="comment-flag-"]').click(function(){var a=$(this).attr("id").replace(/^\D+/g,"");return comment_user_action($(this),a,0,"flag"),!1}),$('button[id^="unban-"]').click(function(){var a=$(this).attr("class").split(" "),b=a[0];b=b.replace(/^\D+/g,"");var c=$(this).attr("id").replace(/^\D+/g,"");return comment_user_action($(this),c,b,"allow"),!1}),$('button[id^="ban-"]').click(function(){var a=$(this).attr("class").split(" "),b=a[0];b=b.replace(/^\D+/g,"");var c=$(this).attr("id").replace(/^\D+/g,"");return comment_user_action($(this),c,b,"ban"),!1})}function confirm_action(a,b){return confirm(a)&&(window.location=b),!1}var arPlayer=null,arDone=!1;$(document).ready(function(){bind_comment_user_actions(),$("#bin-rating-like").click(function(){var a=$(this),b=$("#bin-rating-dislike");$("#bin-rating-response").html("").hide(),$.ajax({type:"GET",url:MELODYURL2+"/ajax.php",data:{vid:$('input[name="bin-rating-uniq_id"]').val(),p:"video",do:"like"},dataType:"json",success:function(c){c.success?a.hasClass("active")?(a.removeClass("active"),$("#rating-bar-up-pct").width(c.up_pct+"%"),$("#rating-bar-down-pct").width(c.down_pct+"%")):(a.addClass("active"),b.removeClass("active"),$("#rating-bar-up-pct").width(c.up_pct+"%"),$("#rating-bar-down-pct").width(c.down_pct+"%"),$("#bin-rating-dislike-confirmation").hide(),$("#bin-rating-like-confirmation").slideDown("normal")):""!=c.msg&&$("#bin-rating-response").html(c.msg).slideToggle("normal")}})}),$("#bin-rating-dislike").click(function(){var a=$($("#bin-rating-like")),b=$(this);$("#bin-rating-response").html("").hide(),$.ajax({type:"GET",url:MELODYURL2+"/ajax.php",data:{vid:$('input[name="bin-rating-uniq_id"]').val(),p:"video",do:"dislike"},dataType:"json",success:function(c){c.success?b.hasClass("active")?(b.removeClass("active"),$("#rating-bar-up-pct").width(c.up_pct+"%"),$("#rating-bar-down-pct").width(c.down_pct+"%")):(b.addClass("active"),a.removeClass("active"),$("#rating-bar-up-pct").width(c.up_pct+"%"),$("#rating-bar-down-pct").width(c.down_pct+"%"),$("#bin-rating-like-confirmation").hide(),$("#bin-rating-dislike-confirmation").slideDown("normal")):""!=c.msg&&$("#bin-rating-response").html(c.msg).slideToggle("normal")}})});var a=!1;$("#pm-vc-playlists").click(function(){a||$.ajax({type:"GET",url:MELODYURL2+"/ajax.php",data:{p:"playlists",do:"video-watch-load-my-playlists","video-id":$(this).attr("data-video-id")},dataType:"json",success:function(b){$("#playlist-container").replaceWith(b.html),a=!0}})}),$(".pm-pro-playlists-btn").click(function(){a||$.ajax({type:"GET",url:MELODYURL2+"/ajax.php",data:{p:"profile",do:"profile-load-playlists",uid:$(this).attr("data-profile-id")},dataType:"json",success:function(b){$("#profile-playlists-container").replaceWith(b.html),a=!0}})}),$('input[name="playlist_name"]').keyup(function(){$(this).val().length>0?$("#create_playlist_submit_btn").removeAttr("disabled"):$("#create_playlist_submit_btn").attr("disabled",!0)}),$("#pm-vc-share").click(function(){$("#securimage-share").prop("src",MELODYURL2+"/include/securimage_show.php?sid="+Math.random())}),$('form[name="sharetofriend"]').submit(function(){return $("#share-confirmation").hide(),$.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:$(this).serialize(),dataType:"json",success:function(a){$("#share-confirmation").html(a.msg).show(),1==a.success&&$('form[name="sharetofriend"]').slideUp()}}),!1}),$("#pm-vc-report").click(function(){$("#securimage-report").prop("src",MELODYURL2+"/include/securimage_show.php?sid="+Math.random())}),$('form[name="reportvideo"]').submit(function(){return $("#report-confirmation").hide(),$.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:$(this).serialize(),dataType:"json",success:function(a){$("#report-confirmation").html(a.msg).show()}}),!1}),$(".pm-video-thumb").hover(function(){var a=$(this);a.find(".watch-later").show(0,function(){a.find(".pm-label-duration").hide()})},function(){var a=$(this);a.find(".watch-later").hide(0,function(){a.find(".pm-label-duration").show()})}),$("#suggest-form").submit(function(){return!1}),$('#suggest-form input[name="yt_id"]').bind("input propertychange",function(a){return""!=$(this).val()&&($("#loading-gif-top").show(),$("#suggest-video-extra").slideUp(),$("#ajax-error-placeholder").html("").fadeOut("fast"),$("#ajax-success-placeholder").html("").fadeOut("fast"),$.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:{p:"suggest",do:"getdata",url:$(this).val()},dataType:"json",success:function(a){$("#loading-gif-top").hide(),a.failed?$("#ajax-error-placeholder").html(a.message).fadeIn("fast"):a.success&&($("#ajax-error-placeholder").hide(),$("#suggest-video-extra").slideDown(),$("#video-thumb-placeholder").html('<div class="suggest-video-placeholder"><img src="'+a.videodata.yt_thumb+'" title="" /></div>').show(),$('#suggest-form input[name="video_title"]').val(a.videodata.video_title),$('#suggest-form textarea[name="description"]').val(a.videodata.description),$('#suggest-form input[name="tags"]').val(a.videodata.tags),$('#suggest-form input[name="source_id"]').val(a.videodata.source_id))}}),!1)}),$('#suggest-form button[type="submit"]').click(function(){if($("#ajax-error-placeholder").html("").hide(),$("#ajax-success-placeholder").html("").hide(),""==$('input[name="video_title"]').val())return $("#ajax-error-placeholder").html(pm_lang.validate_video_title).fadeIn("fast"),$('input[name="video_title"]').trigger("focus"),!1;if("-1"==$('select[name="category"]').val())return $("#ajax-error-placeholder").html(pm_lang.choose_category).fadeIn("fast"),$('select[name="category"]').trigger("focus"),!1;$("#loading-gif-bottom").show();var a=$("#suggest-form").serialize();return $.ajax({type:"POST",url:MELODYURL2+"/ajax.php",data:a,dataType:"json",success:function(a){$("#loading-gif-bottom").hide(),a.failed?$("#ajax-error-placeholder").html(a.message).fadeIn("fast"):a.success&&($("#ajax-error-placeholder").hide(),$("#ajax-success-placeholder").html(a.message).fadeIn("fast"),$("#suggest-video-extra").slideUp(),$("#suggest-form").each(function(){this.reset()}))}}),!1}),$("#preview_comment").hide();var b=!1;$("#c_comment_txt").click(function(){b||0!=$("#c_user_id").val()||($("#captcha-image").prop("src",MELODYURL2+"/include/securimage_show.php?sid="+Math.random()),b=!0)}),$("#c_submit").click(function(){$("#mycommentspan").html('<img src="'+TemplateP+'/img/ajax-loading.gif" alt="Loading" id="loading" /> Posting...').show();var a=$("#c_user_id").val(),b=$("#c_vid").val(),c=$("#c_comment_txt").val(),d=$("#c_username").val(),e=$("#captcha").val();return 0==a?$.post(MELODYURL2+"/comment.php",{username:d,captcha:e,vid:b,user_id:a,comment_txt:c},function(a){1==a.cond?$("#pm-post-form").slideUp("normal",function(){$("#mycommentspan").html(a.html).show(),1==a.preview&&($("#be_the_first").hide(),$("#preview_comment").html(a.preview_html).fadeIn(700))}):0==a.cond&&($("#c_submit").show(),$("#mycommentspan").html(a.html).show())},"json"):a>0&&$.post(MELODYURL2+"/comment.php",{vid:b,user_id:a,comment_txt:c},function(a){1==a.cond?$("#pm-post-form").slideUp("normal",function(){$("#mycommentspan").html(a.html).show(),1==a.preview&&($("#be_the_first").hide(),$("#preview_comment").html(a.preview_html).fadeIn(700))}):0==a.cond&&($("#c_submit").show(),$("#mycommentspan").html(a.html).show())},"json"),!1}),$("#register-form").length&&($('input[name="website"]').is(":visible")||$('input[name="website"]').val(Math.floor(Date.now()/1e3))),$("#autoplayonoff").change(function(){$(this).is(":checked")?(pm_video_data.autoplay_next=!0,$.cookie("pm_autoplay_next","on",{path:"/"})):(pm_video_data.autoplay_next=!1,$.cookie("pm_autoplay_next","off",{path:"/"}))})});